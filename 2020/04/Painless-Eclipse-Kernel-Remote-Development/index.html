<!DOCTYPE HTML>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Painless Eclipse Kernel Remote Development, HX8888979&#39;s blog">
    <meta name="description" content="this document shows how to remotely develop kernel (Makefile Project) through Eclipse with detail configuration and a ex">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Painless Eclipse Kernel Remote Development | HX8888979&#39;s blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    
    <script src="/libs/jquery/jquery.min.js"></script>
    
<meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper head-container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">HX8888979's blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>Tags</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">HX8888979's blog</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			Tags
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        
    </ul>
</div>

        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/2.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Painless Eclipse Kernel Remote Development</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Eclipse/">
                                <span class="chip bg-color">Eclipse</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2020-04-03
                </div>
                

                

                

                
				
                
            </div>
            
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <p><em>this document shows how to remotely develop kernel (Makefile Project) through Eclipse with detail configuration and a example of Weenix</em> </p>
<h2 id="1-Why-Painless"><a href="#1-Why-Painless" class="headerlink" title="1. Why Painless"></a>1. Why Painless</h2><p><em>Are you suffering from following?</em></p>
<ul>
<li>Lag in virtual machine, slow GUI</li>
<li>Blur, Resolution adaptation</li>
<li>Lots of windows while debugging</li>
<li>Frequent switching between host and client system</li>
<li>Lack of modern development tools</li>
<li>Tired to set/unset Debug flag</li>
<li>…</li>
</ul>
<p><em>now, you should try this new method to start your remote development experience<br>build, debug, All in One Key</em></p>
<h2 id="2-Basic-Idea"><a href="#2-Basic-Idea" class="headerlink" title="2. Basic Idea"></a>2. Basic Idea</h2><p>use the latest IDE to code while building or debugging remotely in virtual machine or host</p>
<h2 id="3-Prerequisite"><a href="#3-Prerequisite" class="headerlink" title="3. Prerequisite"></a>3. Prerequisite</h2><ul>
<li>The latest version of Eclipse IDE for C/C++ Developers (<strong><em>2020-03 R</em></strong> currently)</li>
<li>Kernel development system with configured SSH server (for weenix, <strong><em>Ubuntu 16.04 32bit</em></strong>) <strong>!!!</strong> Don’t forget enable X11 forwarding</li>
<li>Stable Internet connection between host system and you (for virtual machine, <strong><em>Host-only</em></strong> will make sure it)</li>
<li>plink (a command-line interface to the PuTTY back ends, you can find it in <strong>PuTTY</strong> package)</li>
<li>X11 Server (For windows, <strong><em>Xming</em></strong> works well for me)</li>
</ul>
<h2 id="4-IDE-Setup"><a href="#4-IDE-Setup" class="headerlink" title="4. IDE Setup"></a>4. IDE Setup</h2><p>For automatically sync all files between remote folder and yours, you should setup a <strong>Synchronized Project</strong> in your Eclipse.</p>
<p>Wait! Before create new project, two things you need to do.</p>
<ol>
<li>Install <strong>Parallel Tools Platform</strong> for your Eclipse to get project template of <strong>Synchronized Project</strong><ul>
<li>In Eclipse, <em>Help - Install New Software…</em> to open Install Window</li>
<li>In *”Work With”<em>, choose corresponding version release url (*</em>“2020-03 - <a href="http://download.eclipse.org/releases/2020-03&quot;" target="_blank" rel="noopener">http://download.eclipse.org/releases/2020-03&quot;</a>**)</li>
<li>Waiting download information</li>
<li>In following multiple choice box, expand <strong>“General Prupose Tools”</strong> and check Parallel Tools Platform (may change in the future, Please refer your eclipse documentation about “Eclipse PTP” )</li>
</ul>
</li>
<li>Get your kernel project in your remote system<ul>
<li>Any way you want. Git, SVN, Copy and Paste and etc. </li>
</ul>
</li>
<li>Configure SSH<ul>
<li>In Eclipse, find *”Connections”* tab close to *”Project Explore”* and switch to it</li>
<li>Click “<em>new connection”</em> icon at right top in this tab<br><img src="newconnection.png" alt="new connection"></li>
<li>Choose *”SSH”* in pop window and click “next”</li>
<li>Fill all connection information field, and click “finish”<br><img src="sshconfiguration.png" alt="ssh configuration"></li>
<li>Test it!</li>
</ul>
</li>
</ol>
<p>Now, it’s time to create your Synchronized Project.</p>
<p>In Eclipse, find *”Project Explore”* and switch to it. Right Click in blank area, Choose *”New - Synchronized C/C++ Project”*<br><img src="newproject.png" alt="new project"><br>Enter your project name any you want.<br>In Remote directory, select *”connection name”* with the SSH connection name you just create. Then Click *”Browse*” followed. Now you will see your remote folder in pop window, select your project folder.<br>In Project Type, Choose *”Makefile project”<em>, and <strong>Only</strong> select *”Linux GCC”</em> in *”remote Toolchain”<em>.<br><img src="newprojectconfiguration.png" alt="new project configuration"><br>Last, Click Finish to create the project<br>After shortly Sync, you should see all your project file in *”project explore”</em></p>
<p>Up to now, all things look well, you could build your project through simply click <strong><em>build</em></strong> button</p>
<h2 id="5-Remotely-Launch-and-Debug"><a href="#5-Remotely-Launch-and-Debug" class="headerlink" title="5. Remotely Launch and Debug"></a>5. Remotely Launch and Debug</h2><p>First, we will use plink to connect to our remote system and excute <strong><em>qemu</em></strong> to load our kernel and wait it launch successfully.</p>
<ol>
<li><p>Launch</p>
<p> In Eclipse, find *”Debug Configurations”* and double click *”C/C++ Application”* to create new configuration, which I set name “Weenix Startup”  </p>
<p> In Main tab, choose the right project and browse right path of plink for C/C++ Application<br> Switch to Arguments tab, paste following code (of course, you can write one for yourself, it just like shell)</p>
<p> <em>For Weenix only: this part of codes just like what did in <strong><em>weenix</em></strong> script</em></p>
<pre><code> {username}@{remote IP} -X -pw {PASSWORD} &quot;cd {remote project path}; qemu-system-i386 -k en-us -boot order=dca -m 256 -cdrom kernel/weenix.iso -drive format=raw,file=user/disk0.img -serial stdio -s -S &amp; while !(netstat -ntlp 2&gt;/dev/null | grep :1234); do echo &#39;waiting qemu gdbserver&#39;; sleep 1; done; echo &#39;gdbserver ready&#39;&quot;</code></pre><p> Replace {username}, {remote IP}, {PASSWORD} and {remote project path} correctly.<br> If you need any extra argument for qemu you can modify<br> <strong>*”qemu-system-i386 -k en-us -boot order=dca -m 256 -cdrom kernel/weenix.iso -drive format=raw,file=user/disk0.img -serial stdio -s -S”*</strong> correspondingly<br> <img src="startup.png" alt="start up"></p>
<p> Plink will forward qemu window to you! So you even can use *”headless start”* to start your VM to save more system resource or Even <strong><em>ubuntu server</em></strong>!<br> <img src="headless.png" alt="headless"><br> For more detail, Please refer documentation of <strong><em>Plink</em></strong></p>
</li>
<li><p>Debug</p>
<p> Still in Debug Configurations, double click *”C/C++ Remote Application”* to create new configuration, which I set name “Weenix Debugger”  </p>
<p> In Main tab, choose the right project and write *”kernel/weenix.dbg”* for C/C++ Application, or you can “Search Project” if you build project and sync before<br> In Debugger tab, Stop at “kmain” (of course, you can write others you want) and make sure GDB command file is default value “.initgdb” if you want to use weenix kernel debug commands (we enable it later)<br> Switch to Source tab, Click “Add” and choose “Path Mapping”. Give any mapping name you want and write your remote project folder and local project folder correctly. it will make sure GDB can find symbol file while debugging.</p>
</li>
<li><p>Combination</p>
<p> Now, we just need combine them. Still in Debug Configurations, double click *”Launch Group”* to create new configuration, which I set name “Weenix”</p>
<p> Click “Add” to add our <strong><em>Weenix Startup</em></strong> and <strong><em>Weenix Debugger</em></strong>. Make sure Launch mode is Run when you add Weenix Startup. <strong><em>Post launch action</em></strong> is <strong><em>Wait for console output (regexp)</em></strong> and <strong><em>Regular Expression</em></strong> is <strong>*”gdbserver ready”*</strong> (if you use my code in <strong>step 5.1</strong>)<br> <img src="weenixstartup.png" alt="weenix startup"><br> <img src="combination.png" alt="combination"><br> All Set! just modify default debug configuration is <strong><em>Weenix</em></strong><br> <img src="combinationall.png" alt="combination all"></p>
<p> Try it, all thing will work automatically (<strong><em>Don’t forget to start your X11 server!</em></strong>)</p>
</li>
</ol>
<h2 id="6-Weenix-Only-Where-is-my-weenix-kernel-debug-commands"><a href="#6-Weenix-Only-Where-is-my-weenix-kernel-debug-commands" class="headerlink" title="6. (Weenix Only) Where is my weenix kernel debug commands?"></a>6. (Weenix Only) Where is my weenix kernel debug commands?</h2><p>What? Why can’t I use kernel in debugger console?</p>
<p>Cause we didn’t source commands file when gdb start.</p>
<p>Now, we create a .initgdb (keep same name in <strong>step 5.2</strong>) in the local project folder<br>paste following code</p>
<pre><code>python sys.path.append(&quot;./python&quot;)
b kmain
comm
source kernel/main/gdt.gdb
source kernel/mm/pagetable.gdb
source kernel/mm/page.py
source kernel/mm/memcheck.py
source kernel/mm/slab.py
source kernel/proc/kthread.gdb
source kernel/proc/proc.py
source kernel/util/debug.py
source kernel/util/list.py
source kernel/vm/vmmap.gdb
echo kernel help function loaded, type &quot;help kernel&quot; to show more detail
end</code></pre><p>it will break kernel in kmain and load all commands file, if all things right you will see “kernel help function loaded, type “help kernel” to show more detail” in your gdb console<br><img src="gdbcommands.png" alt="gdb commands"></p>
<h2 id="7-More"><a href="#7-More" class="headerlink" title="7. More"></a>7. More</h2><ul>
<li>The tty output from qemu will be put in console. Cause there may be muliple console windows, you may need to switch to right one.</li>
<li><strong>colored output</strong>, if you want, <strong>*”ANSI Escape in Console”*</strong> is good for that in plugin market. No config needed!</li>
</ul>

            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://hx8888979.github.io" rel="external nofollow noreferrer">HX8888979</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://hx8888979.github.io/2020/04/Painless-Eclipse-Kernel-Remote-Development/">http://hx8888979.github.io/2020/04/Painless-Eclipse-Kernel-Remote-Development/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    reprint polocy. If reproduced, please indicate source
                    <a href="http://hx8888979.github.io" target="_blank">HX8888979</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Eclipse/">
                                    <span class="chip bg-color">Eclipse</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;Current
            </div>
            <div class="card">
                <a href="/2020/04/Painless-Eclipse-Kernel-Remote-Development/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/2.jpg" class="responsive-img" alt="Painless Eclipse Kernel Remote Development">
                        
                        <span class="card-title">Painless Eclipse Kernel Remote Development</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            this document shows how to remotely develop kernel (Makefile Project) through Eclipse with detail configuration and a ex
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-04-03
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            HX8888979
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Eclipse/">
                        <span class="chip bg-color">Eclipse</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Current&nbsp;<i class="far fa-dot-circle"></i>
            </div>
            <div class="card">
                <a href="/2020/04/Painless-Eclipse-Kernel-Remote-Development/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/2.jpg" class="responsive-img" alt="Painless Eclipse Kernel Remote Development">
                        
                        <span class="card-title">Painless Eclipse Kernel Remote Development</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            this document shows how to remotely develop kernel (Makefile Project) through Eclipse with detail configuration and a ex
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-04-03
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            HX8888979
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Eclipse/">
                        <span class="chip bg-color">Eclipse</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + 'From: HX8888979's blog<br />'
            + 'Author: HX8888979<br />'
            + 'Link: <a href="' + url + '">' + url + '</a><br />'
            + 'Copyright © 2020 HX8888979. All rights reserved';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>

    
<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>

    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>



    <footer class="page-footer bg-color">
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2020</span>
            <a href="http://hx8888979.github.io" target="_blank">HX8888979</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
            
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link ">
    <a href="https://github.com/hx8888979" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:hx8888979@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162751350-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'UA-162751350-1');
</script>


    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    

    

    

    

    

    
    
    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
